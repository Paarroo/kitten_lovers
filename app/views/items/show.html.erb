<div class="container py-5">
  <!-- Introduction -->
  <p class="text-center fs-5 mb-5">
    Un chaton suffit...<br>
    Chaque image en capture la magie, entre innocence fragile et mystère silencieux
  </p>

  <!-- Main block -->
  <div class="row align-items-center bg-light rounded-4 p-4" style="background-color: #fbf5ec;">

    <!-- Text to the left -->
    <div class="col-md-6">
      <h1 class="display-6 fw-bold mb-3"><%= @item.title %></h1>

      <p class="mb-4 text-muted"><%= @item.description %></p>

      <p class="fs-5 fw-semibold mb-4">Prix : <%= number_to_currency(@item.price) %></p>

      <%# Correction: utiliser has_purchased? au lieu de already_purchased? %>
      <% if current_user&.has_purchased?(@item) %>
        <p class="text-success fw-semibold mb-4">✅ Déjà acheté.</p>

        <div class="d-flex gap-3">
          <%= link_to "Voir mes achats", purchased_items_path, class: "btn btn-primary btn-custom" %>
          <%= link_to "Télécharger", "#", class: "btn btn-secondary btn-custom" %>
        </div>
      <% else %>
        <div class="d-flex gap-3">
          <%= button_to "Ajouter au panier",
                        cart_cart_items_path(item_id: @item.id),
                        method: :post,
                        class: "btn btn-primary btn-custom" %>

          <%# Removed direct purchase button - using cart flow %>
          <%= link_to "Acheter maintenant",
                      cart_path,
                      class: "btn btn-secondary btn-custom" %>
        </div>
      <% end %>
    </div>

    <!-- Picture to the right -->
    <div class="col-md-6 text-center mt-4 mt-md-0">
      <%= image_tag @item.image_url, class: "img-fluid rounded-4 shadow-sm", style: "max-height: 400px;" %>
    </div>
  </div>
</div>
